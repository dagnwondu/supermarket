{% extends 'lab_page/lab_base.html' %} {% block content %}
<div class="container-fluid">
  <h6>Welcome, {{ request.user }}</h6>
  <h3 class="mt-4 text-center">Lab Requests with Completed Payments</h3>

  <div class="container">
    <div class="col">
      <table class="table table-striped table-hover table-bordered">
        <thead>
          <tr>
            <th scope="col">S.No</th>
            <th scope="col">Patient Name</th>
            <th scope="col">Service Name</th>
            <th scope="col">Time Assigned</th>
            <th scope="col">Insert Result</th>
          </tr>
        </thead>
        <tbody>
          {% for payment in completed_payments %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>
              {% if payment.patient.full_name %} {{ payment.patient.full_name }}
              {% else %} N/A {% endif %}
            </td>
            <td>{{ payment.service_type.name }}</td>
            <td>{{ payment.created_at|default:"N/A" }}</td>
            <td>
              <a
                href="{% url 'insert_result' payment.patient.id %}"
                class="btn btn-primary"
              >
                Insert Result
              </a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center">No lab requests found</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
