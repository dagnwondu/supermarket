{% extends 'base.html' %}

{% block content %}

<div class="card card-simple p-4">
    <h4>Sales</h4>

    <!-- FILTERS -->
    <form method="GET" class="row g-3 mt-3">

        <div class="col-md-3">
            <label>Search Product</label>
            <input type="text" name="search" value="{{ values.search }}" class="form-control">
        </div>

        <div class="col-md-3">
            <label>Category</label>
            <select name="category" class="form-control">
                <option value="">All</option>
                {% for c in categories %}
                <option value="{{ c.id }}" {% if values.category == c.id|stringformat:"s" %}selected{% endif %}>
                    {{ c.name }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-3">
            <label>Product</label>
            <select name="product" class="form-control">
                <option value="">All</option>
                {% for p in products %}
                <option value="{{ p.id }}" {% if values.product == p.id|stringformat:"s" %}selected{% endif %}>
                    {{ p.name }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-3">
            <label>Date From</label>
            <input type="date" name="date_from" value="{{ values.date_from }}" class="form-control">
        </div>

        <div class="col-md-3">
            <label>Date To</label>
            <input type="date" name="date_to" value="{{ values.date_to }}" class="form-control">
        </div>

        <div class="col-md-3">
            <label>Min Price</label>
            <input type="number" step="0.01" name="price_min" value="{{ values.price_min }}" class="form-control">
        </div>

        <div class="col-md-3">
            <label>Max Price</label>
            <input type="number" step="0.01" name="price_max" value="{{ values.price_max }}" class="form-control">
        </div>

        <div class="col-md-3 d-flex align-items-end">
            <button class="btn btn-primary w-100">Filter</button>
        </div>
    </form>

    <!-- SALES TABLE -->
    <table class="table table-bordered table-striped mt-4">
        <thead>
            <tr>
                <th>Product</th>
                <th>Qty</th>
                <th>Total Price</th>
                <th>Date</th>
            </tr>
        </thead>

        <tbody>
            {% for sale in sales %}
            <tr>
                <td>{{ sale.product.name }}</td>
                <td>{{ sale.quantity }}</td>
                <td>{{ sale.total_price }}</td>
                <td>{{ sale.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center text-muted">No results found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
