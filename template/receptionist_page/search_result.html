{% extends 'reception_page/reception_base.html'%} {% block content %}

<h6>Welcome: {{ user.first_name }}</h6>
<h3 style="text-align: center">Manage Patients</h3>

{% if messages %}
<div class="alert alert-info">
  {% for message in messages %}
  <div class="alert alert-{{ message.tags }}">{{ message }}</div>
  {% endfor %}
</div>
{% endif %}




<!-- Patient Table -->
{% if patients %}
<div class="container">
  <div class="col">
    <table class="table table-striped table-hover table-bordered">
      <tr>
        <th scope="col">Full Name</th>
        <th scope="col">Phone Number</th>
        <th scope="col">Assignment</th>
        <th scope="col">Edit Info</th>
      </tr>
      {% for patient in patients %}
      <tr>
        <td>{{ patient.full_name }}</td>
        <td>{{ patient.phone_number }}</td>
        <td>
          <!-- Button to trigger the password change modal -->
          <button
            type="button"
            class="btn btn-warning btn-sm"
            data-bs-toggle="modal"
            data-bs-target="#assignPatientModal{{ patient.id }}"
          >
            Assign Patient
          </button>
        </td>
        <td>
          <form method="post" action="{% url 'update_patient' patient.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary btn-sm">Update</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>
</div>
{% else %}
<p>No Searched Patient found.</p>
{% endif %}

            <!-- Modal for Assigning patient -->
            <div
              class="modal fade"
              id="assignPatientModal{{ patient.id }}"
              tabindex="-1"
              aria-labelledby="assignPatientModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <form
                    method="POST"
                    action=""
                  >
                    {% csrf_token %}
                    <div class="modal-header">
                      <h5 class="modal-title" id="assignPatientModalLabel">
                        Assign Patient {{ patient.first_name }} {{
                        patient.middle_name }} to
                      </h5>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      ></button>
                    </div>
                    <div class="modal-body">
                      <div class="mb-3">
                        <select name="doctor_name" id="">
                          <option value="">Doctor Chala</option>
                          <option value="">Doctor kebede</option>
                        </select>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button
                        type="button"
                        class="btn btn-secondary"
                        data-bs-dismiss="modal"
                      >
                        Close
                      </button>
                      <button type="submit" class="btn btn-primary">
                        Assign
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </table>
        </div>
      </div>

      {% endblock %}
    </table>
  </div>
</div>
